!function(){function t(e){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t(e)}(0,window.define)("idcta-v2/idCookie",["idcta-v2/id-config","idcta-v2/logger","idcta-v2/analytics","idcta-v2/apiUtils"],(function(e,o,r,i){var n={},a=864e5;r.setLoggingEnabled(!1);var c,s=e.getDomain(),u=e.getIdentity()&&e.getIdentity().idSignedInCookieName?e.getIdentity().idSignedInCookieName:"ckns_id",g=e.getIdentity()&&e.getIdentity().cookieAgeDays?e.getIdentity().cookieAgeDays:730,h=e.getIdentity()&&e.getIdentity().accessTokenCookieName?e.getIdentity().accessTokenCookieName:"ckns_atkn";function l(t){try{var o,r=(o=e.getFeatureDecisions().welshUnicodeDecode?/^([A-Za-z0-9+/]{4})*([A-Za-z0-9+/]{3}=|[A-Za-z0-9+/]{2}==)?$/.test(t)?window.atob(t):decodeURIComponent(atob(decodeURIComponent(t)).split("").map((function(t){return"%".concat("00".concat(t.charCodeAt(0).toString(16)).slice(-2))})).join("")):window.atob(t)).lastIndexOf("}"),i=o.substring(0,r+1);return JSON.parse(i)}catch(t){return null}}function d(){return e.getFeatureDecisions().welshUnicodeDecode?new RegExp("".concat(u,"=([^;]+)")):new RegExp("".concat(u,"=([\\w]+)"))}function p(t,e,r,i){try{e=e||"";var n="";if(r){var a=new Date;a.setTime(a.getTime()+r),n="Expires=".concat(a.toUTCString(),"; ")}e=i?window.btoa(e):e,document.cookie="".concat(t,"=").concat(e,"; ").concat(n,"Domain=").concat(s,"; Path=/")}catch(t){o.logCaughtError(t)}}function y(){var r=this;function n(t){return Object.prototype.hasOwnProperty.call(t,"ps")&&Object.prototype.hasOwnProperty.call(t,"jwt-exp")&&Object.prototype.hasOwnProperty.call(t,"tkn-exp")&&(t.hy||Object.prototype.hasOwnProperty.call(t,"ses-exp"))}function c(){r.valid=!1,r.id="",r.username="~",r.displayname="",r.timestamp=""}function y(){var t=d(),e=document.cookie.match(t);if(e){var o=l(e[1]);o&&n(o)&&!function(t){var e=(new Date).getTime();return(t["jwt-exp"]||0)<=e}(o)?(r.valid=!0,r.displayname=o.dn,r.timestamp=o["jwt-exp"]):c()}else c()}this.valid=!1,this.id="",this.username="~",this.displayname="",this.timestamp="",this.cookieAgeDays=g,this.isIdv5On=!0,this.refreshCookie=function(){try{y()}catch(t){o.logCaughtError(t)}},this.hasCookie=function(){try{return t=r.cookieAgeDays*a,(new Date).getTime()-r.timestamp>=t&&c(),r.valid}catch(t){o.logCaughtError(t)}var t},this.hasAccessTokenExpired=function(){try{var t=this.getUserDetailsFromCookie();if(!t)return!0;var e=(new Date).getTime();return(t["tkn-exp"]||0)<=e}catch(t){o.logCaughtError(t)}},this.hasJwtTokenExpired=function(){try{var t=this.getUserDetailsFromCookie();if(!t)return!0;var e=(new Date).getTime();return(t["jwt-exp"]||0)<=e}catch(t){o.logCaughtError(t)}},this.isHybridApp=function(){try{var t=this.getUserDetailsFromCookie();return t&&t.hy||!1}catch(t){o.logCaughtError(t)}},this.getError=function(){try{var t=this.getUserDetailsFromCookie();return t&&t.ec||null}catch(t){o.logCaughtError(t)}},this.getIdFromCookie=function(){try{var t=this.getUserDetailsFromCookie();return t?t.ps:null}catch(t){o.logCaughtError(t)}},this.getHidFromCookie=function(){return this.getCookie("ckns_sylphid")||this.getCookie("ckpf_sylphid")},this.getEmailDigest=function(){var e=this.getUserDetailsFromCookie();return e&&"object"===t(e.ed)?e.ed:null},this.getFedId=function(){var e=this.getUserDetailsFromCookie();return e&&"object"===t(e.fi)?e.fi:null},this.isPersonalisationEnabled=function(){try{var t=this.getUserDetailsFromCookie();return t&&t.ep}catch(t){return o.logCaughtError(t),!1}},this.getUserDetailsFromCookie=function(){try{if(!this.hasCookie())return null;var t=d(),e=document.cookie.match(t);if(!e)return null;var r=l(decodeURIComponent(e[1]).split("|").toString());return r&&n(r)?r:null}catch(t){o.logCaughtError(t)}},this.getNameFromCookie=function(){try{return this.hasCookie()&&r.displayname&&""!==r.displayname?r.displayname.replace(/\+/g," "):null}catch(t){o.logCaughtError(t)}},this.getRealmFromCookie=function(){try{return this.hasCookie()?this.getUserDetailsFromCookie().realm||"/":null}catch(t){o.logCaughtError(t)}},this.getAccessToken=function(){try{if(!this.hasCookie())return null;var t=new RegExp("".concat(h,"=([^;]*)")),e=document.cookie.match(t);return null!==e?e[1]:null}catch(t){o.logCaughtError(t)}},this.getCookie=function(t,e){try{var r=new RegExp("".concat(t,"=([^\\s;]*)")),i=document.cookie.match(r);return i?!0!==e?i[1]:l(decodeURIComponent(i[1])):null}catch(t){o.logCaughtError(t)}},this.setCknsIdCookieProperty=function(t,r){try{var i=this.getUserDetailsFromCookie();if(!i)return;if(r?i[t]=r:delete i[t],!e.getFeatureDecisions().fixCknsIdExpiry){var n=i["jwt-exp"]?i["jwt-exp"]:a*g;return void p(u,JSON.stringify(i),n,!0)}var c="number"==typeof i["rtkn-exp"]&&new Date(i["rtkn-exp"])-new Date||72e5;p(u,JSON.stringify(i),c,!0)}catch(t){o.logCaughtError(t)}},this.calculatePn=function(t){var r=arguments.length>1&&void 0!==arguments[1]&&arguments[1];try{if(!(t=t||this.getUserDetailsFromCookie()))return 0;var n=e.getFeatureDecisions(),a="gb"===t.cc;n.forYouGeoIp&&(a=r);var c=t.pn||0,s=!this.getCookie("ckns_profile")&&"u13"!==t.ab&&t.ep&&a;return s&&!c?(c=i.generateHashValue(t.ps),this.setCknsIdCookieProperty("pn",c)):!s&&c&&(this.setCknsIdCookieProperty("pn"),c=0),c}catch(t){console.log("err: ",t),o.logCaughtError(t)}},this.checkForYouEligibility=function(t){var r=arguments.length>1&&void 0!==arguments[1]&&arguments[1];try{var i=e.getFeatureDecisions();if(!t)return!1;var n="gb"===t.cc;return i.forYouGeoIp&&(n=r),!this.getCookie("ckns_profile")&&"u13"!==t.ab&&t.ep&&n}catch(t){console.log("err: ",t),o.logCaughtError(t)}},this.unsetCookie=function(t){try{document.cookie="".concat(t,"=; Expires=Thu, 01 Jan 1970 00:00:00 GMT; Domain=").concat(s,"; Path=/")}catch(t){o.logCaughtError(t)}},y()}return r.setLoggingEnabled(!0),n.getInstance=function(){try{return c?(c.refreshCookie(),c):c=new y}catch(t){o.logCaughtError(t)}},n.setInstance=function(t){try{c=t}catch(t){o.logCaughtError(t)}},n}))}();