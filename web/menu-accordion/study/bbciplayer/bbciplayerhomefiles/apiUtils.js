!function(){function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(t)}function t(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function r(e){for(var r=1;r<arguments.length;r++){var o=null!=arguments[r]?arguments[r]:{};r%2?t(Object(o),!0).forEach((function(t){n(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):t(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}function n(t,r,n){return(r=function(t){var r=function(t){if("object"!=e(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,"string");if("object"!=e(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==e(r)?r:r+""}(r))in t?Object.defineProperty(t,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[r]=n,t}(0,window.define)("idcta-v2/apiUtils",["idcta-v2/es6-promise","idcta-v2/logger"],(function(e,t){var n={},o="account_sequence_id";function a(e,t){var r=t.substring(0,t.indexOf("=")+1);if(e.indexOf(r)>-1)return e;var n=e.split("#"),o=e.indexOf("?")>-1?"&":"?";return n.length>1?"".concat(n[0]+o+t,"#").concat(n[1]):e+o+t}return n.verifyEndpointUrl=function(e,r){try{if(!1!==r&&(r=!0),/https?:\/\/(((www|ssl)(\.int|\.test|\.stage)?)|(pal\.sandbox\.dev))\.bbc\.(co\.uk|com)/.test(e))return/(\.com|\.co\.uk)\/.+/.test(e)&&(e=e.split(/(\.com|\.co\.uk)\/.+/)[0]+e.split(/(\.com|\.co\.uk)\/.+/)[1]),e;var n="";"https"===e.slice(0,5)?(n+="".concat(r?"https://":"","ssl."),e.indexOf(".sandbox.")>-1&&(n+="sandbox.dev.")):(n+=r?"http://":"",e.indexOf(".sandbox.")>-1?n+="pal.sandbox.dev.":n+="www.");for(var o=["int","test","stage"],a=0;a<o.length;a+=1)e.indexOf(".".concat(o[a],"."))>-1&&(n+="".concat(o[a],"."));return/\.co\.uk/.test(e)?n+="bbc.co.uk":n+="bbc.com",n}catch(e){t.logCaughtError(e)}},n.alignTldWithHostname=function(e,r){try{var n=(r||window.location.hostname).split(/(\.com|\.co\.uk)$/)[1],o=e.split(/(\.com|\.co\.uk)\/.+/)[1];return o!==n&&void 0!==n&&(e=e.replace(o,n)),e}catch(e){t.logCaughtError(e)}},n.addQueryParameter=a,n.appendProductToCtaElement=function(e){var t="",r="",o="userOrigin=",c="context=",i=e.getAttribute("href");if(i&&(-1===i.indexOf(o)||-1===i.indexOf(c)))return n.getProductNameAsync().then((function(i){if(void 0!==i&&""!==i){t=o+i.userOrigin,r=c+i.context;var s=e.getAttribute("href"),u=n.parseUrl(s);if(u){var g=u.pathname;-1===u.pathname.indexOf("/")&&(g="/".concat(u.pathname)),e.setAttribute("href","".concat(u.protocol,"//").concat(u.host).concat(g).concat(a(a(u.search,t),r)).concat(u.hash))}}}))},n.appendQueryParameters=function(e,t){var n=e.split("#"),o=n[0],a=n[1],c=o.split("?"),i=c[1],s=r(r({},i?i.split("&").reduce((function(e,t){var r=t.split("="),n=r[0],o=r[1];return e[n]=o,e}),{}):{}),t),u=Object.keys(s).map((function(e){return"".concat(e,"=").concat(s[e])})).join("&"),g=u?"".concat(c[0],"?").concat(u):c[0];return a?"".concat(g,"#").concat(a):g},n.getProductNameAsync=function(){var e={context:"",userOrigin:""};return window.bbcpage&&window.bbcpage.getDestination?window.bbcpage.getDestination().then((function(t){return t?{context:t.replace(/_TEST$/i,"").replace(/_PS$/i,"").replace(/_GNL$/i,"").toLowerCase(),userOrigin:t}:e})):n.Promise.resolve(e)},n.Promise=function(){try{return"undefined"!=typeof Promise?Promise:e.Promise}catch(e){t.logCaughtError(e)}}(),n.loadUrlInHiddenIframe=function(e,r,o){try{return new n.Promise((function(a,c){t.logMessage("".concat('Creating iframe {src: "').concat(e,'", ')+"timeout: ".concat(r).concat(o?', expectedPostMessages: ["'.concat(o.join('", "'),'"]}'):"}"));var i=document.createElement("iframe");i.scrolling="no",i.frameborder="0",i.width="0px",i.height="0px",i.border="0px",i.style.display="none",i.style.frameBorder="0px",i.style.borderStyle="none";var s=null,u=function(){s&&clearTimeout(s),o&&n.removeEventListener("message",g),document.body.removeChild(i)},g=function(e){var r=e.message?"message":"data";if(e.origin.match(/\.bbc\.(co\.uk|com)(:[0-9]+)*$/)&&-1!==o.indexOf(e[r]))return t.logMessage('Iframe received message "'.concat(e[r],'", resolving')),u(),a(e[r]);t.logMessage('Iframe received unexpected message "'.concat(e[r],'", ignoring'))};o?n.addEventListener("message",g):i.onload=function(){return t.logMessage('Iframe with src "'.concat(e,'" loading complete')),u(),a()},r&&(s=setTimeout((function(){return t.logMessage("Iframe with src ".concat(e," timed out after ").concat(r," milli seconds")),u(),c()}),r)),i.src=e,document.body.appendChild(i)}))}catch(e){t.logCaughtError(e)}},n.addEventListener=function(e,t,r){n.addEventListenerTo(window,e,t,r)},n.addEventListenerTo=function(e,r,n,o){try{return e.addEventListener?e.addEventListener(r,n,o):(r="message"===r?"onmessage":r,e.attachEvent(r,n))}catch(e){t.logCaughtError(e)}},n.removeEventListener=function(e,t){n.removeEventListenerFrom(window,e,t)},n.removeEventListenerFrom=function(e,r,n){try{return e.removeEventListener?e.removeEventListener(r,n):(r="message"===r?"onmessage":r,e.detachEvent(r,n))}catch(e){t.logCaughtError(e)}},n.getEnvFromUrl=function(){try{var e=window.location.href;return e.indexOf(".sandbox.")>-1?".sandbox.dev":e.indexOf(".int.")>-1?".int":e.indexOf(".test.")>-1?".test":e.indexOf(".stage.")>-1?".stage":""}catch(e){t.logCaughtError(e)}},n.parseUrl=function(e){try{var r=document.createElement("a");return r.href=e,r.query=r.search?n.parseQueryString(r.search):{},r}catch(e){t.logCaughtError(e)}},n.parseQueryString=function(e){try{"?"===e.charAt(0)&&(e=e.substring(1));for(var r={},n=e.split("&"),o=0;o<n.length;o+=1){var a=n[o].split("=");r[decodeURIComponent(a[0])]=decodeURIComponent(a[1]||"")}return r}catch(e){t.logCaughtError(e)}},n.timestampInFuture=function(e){try{return e>(new Date).getTime()}catch(e){t.logCaughtError(e)}},n.timestampExpired=function(e){try{return e<(new Date).getTime()}catch(e){t.logCaughtError(e)}},n.generateFutureTimestamp=function(e){try{e=e||36e5;var r=new Date;return r.setTime(r.getTime()+e),r.getTime()}catch(e){t.logCaughtError(e)}},n.getStatusURL=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=arguments.length>3?arguments[3]:void 0,o=arguments.length>4?arguments[4]:void 0;if("GREEN"!==t["foryou-flagpole"])return{statusURL:t.status_url,statusName:"settings"};var a=e.getUserDetailsFromCookie();if(o)return e.checkForYouEligibility(a,n)?{statusURL:t.foryou_url,statusName:"foryou"}:{statusURL:t.status_url,statusName:"settings"};var c=a.ps;if(t.forYouAllowlist&&t.forYouAllowlist.includes(c))return{statusURL:t.foryou_url,statusName:"foryou"};t["foryou-access-chance"]&&(r=t["foryou-access-chance"],r=Number(r));var i=a.pn&&a.pn<=r;return{statusURL:i?t.foryou_url:t.status_url,statusName:i?"foryou":"settings"}},t.logCaughtError=function(e){window.console&&e.message&&console.log(e)},t.logMessage=function(e){document.cookie.match(new RegExp("".concat("ckns_debugtoken","=([^;]+)")))&&(window.tokenRefeshLog=window.tokenRefeshLog||[],window.tokenRefeshLog.push(e))},n.generateHashValue=function(e){if(!e)return 0;var t=0;return e.split("").forEach((function(r,n){var o=e.charCodeAt(n);t=(t<<5>>>0)-t+o,t|=0,t>>>=0})),t=t%100+1,t=Math.abs(t)},n.generateUuid=function(){return window.crypto&&"function"==typeof window.crypto.randomUUID?window.crypto.randomUUID():Math.random().toString(36).slice(2)},n.removeSequenceId=function(){try{sessionStorage.removeItem(o)}catch(e){t.logCaughtError(e)}},n.getSequenceId=function(){try{return sessionStorage.getItem(o)||sessionStorage.setItem(o,n.generateUuid()),sessionStorage.getItem(o)}catch(e){return n.generateUuid()}},n}))}();