!function(){function e(e,n){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var a,i,r,c,o=[],s=!0,l=!1;try{if(r=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;s=!1}else for(;!(s=(a=r.call(n)).done)&&(o.push(a.value),o.length!==t);s=!0);}catch(e){l=!0,i=e}finally{try{if(!s&&null!=n.return&&(c=n.return(),Object(c)!==c))return}finally{if(l)throw i}}return o}}(e,n)||function(e,n){if(e){if("string"==typeof e)return t(e,n);var a={}.toString.call(e).slice(8,-1);return"Object"===a&&e.constructor&&(a=e.constructor.name),"Map"===a||"Set"===a?Array.from(e):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?t(e,n):void 0}}(e,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function t(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=Array(t);n<t;n++)a[n]=e[n];return a}(0,window.define)("idcta-v2/statusbar",["idcta-v2/idCookie","idcta-v2/id-config","idcta-v2/logger","idcta-v2/analytics","idcta-v2/apiUtils"],(function(t,n,a,i,r){var c={};function o(i,c){return Promise.all([n.getConfigAsync(),window.bbcuser.isUKCombined()]).then((function(a){var o=e(a,2),s=o[0],l=o[1],u=c.getNameFromCookie(),d=s.translation_signedin,m=i.element.className;if(u){var f=u.substring(0,1).toUpperCase();d=u,i.element.className="".concat(i.element.className," idcta-avatar"),i.ctaLink.setAttribute("userInitial",f)}if(i.element.className="".concat(i.element.className," idcta-signedin"),"GREEN"===s["foryou-flagpole"]){var g=n.getFeatureDecisions(),h=t.getInstance();if(g.welshUnicodeDecode&&!g.removeForYouAccessChanceCheck){var y=h.getUserDetailsFromCookie();h.calculatePn(y,l)}"foryou"===r.getStatusURL(h,s,void 0,l,g.removeForYouAccessChanceCheck).statusName&&(d=s.translation_foryou,!!document.getElementById("idcta-placeholder-id")||(i.element.className="".concat(m," idcta-foryou")),g.enableSequenceId&&r.removeSequenceId())}i.ctaName.innerText=d})).catch((function(e){a.logCaughtError(e)}))}return c.Statusbar=function(i){try{if(this.id=null,this.element=null,this.ctaLink=null,this.ctaName=null,function(e){return!(!document.getElementById(e.id)||!e.blq&&!document.getElementById("idcta-link")||e.blq&&!document.getElementById(e["link-id"]))}(i)){this.id=i.id,this.element=document.getElementById(i.id);var c=n.getFeatureDecisions();if(i.blq)this.ctaLink=document.getElementById(i["link-id"])?document.getElementById(i["link-id"]):this.element.getElementsByTagName("a")[0],this.ctaName=i["name-id"]?document.getElementById(i["name-id"]):this.element.getElementsByTagName("span")[1];else{this.ctaLink=document.getElementById("idcta-link");var s=e(this.element.getElementsByTagName("span"),1);this.ctaName=s[0]}document.getElementById("idcta-placeholder-id")&&this.ctaLink&&document.getElementById(i.id).classList.add("blue-user-icon");var l=this;!0===i.publiclyCacheable&&(t.getInstance().hasCookie()?c.forYouGeoIp?Promise.all([n.getConfigAsync(),window.bbcuser.isUKCombined()]).then((function(n){var a=e(n,2),i=a[0],s=a[1];if("GREEN"===i["foryou-flagpole"]){var u=t.getInstance();if(c.welshUnicodeDecode&&!c.removeForYouAccessChanceCheck){var d=u.getUserDetailsFromCookie();u.calculatePn(d,s)}var m=r.getStatusURL(u,i,void 0,s,c.removeForYouAccessChanceCheck).statusURL;m&&l.ctaLink.href!==m&&(l.ctaLink.href=m)}else i.status_url&&l.ctaLink.href!==i.status_url&&(l.ctaLink.href=i.status_url);o(l,t.getInstance())})):n.getConfigAsync().then((function(e){if("GREEN"===e["foryou-flagpole"]){var a=n.getFeatureDecisions(),i=t.getInstance(),c=i.getUserDetailsFromCookie(),s=c&&"gb"===c.cc;a.welshUnicodeDecode&&(a.removeForYouAccessChanceCheck||i.calculatePn(c,s));var u=r.getStatusURL(i,e,void 0,s,a.removeForYouAccessChanceCheck).statusURL;u&&l.ctaLink.href!==u&&(l.ctaLink.href=u)}else e.status_url&&l.ctaLink.href!==e.status_url&&(l.ctaLink.href=e.status_url);o(l,t.getInstance())})):n.getConfigAsync().then((function(e){e.signin_url&&(l.ctaLink.href=e.signin_url,c.enableSequenceId&&(l.ctaLink.href=r.appendQueryParameters(l.ctaLink.href,{sequenceId:r.getSequenceId()}))),l.ctaName.innerText=e.translation_signedout})))}var u=document.getElementById("idcta-statusbar"),d=document.getElementById("idcta-placeholder-id");u&&u.classList.add("opacity-one"),d&&d.classList.add("display-none")}catch(e){a.logCaughtError(e)}},c.updateForAuthorisedState=o,c}))}();